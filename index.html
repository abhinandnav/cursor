<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Magnifying Glass Cursor</title>

  <style>
    :root {
      --magnifier-size: 160px;   /* diameter of the magnifying glass */
      --magnifier-zoom: 2;       /* magnification factor */
    }

    html, body {
      height: 100%;
      margin: 0;
    }

    body {
      margin: 0;
      padding: 40px;
      min-height: 200vh;
      font-family: Arial, Helvetica, sans-serif;
      background-color: #ffffff;

      /* fallback cursor image (keep magnifying.png next to index.html) */
      cursor: url("magnifying.png") 16 16, zoom-in;
    }

    /* Page content we will magnify */
    .content {
      position: relative; /* needed so clone dimensions match */
      max-width: 900px;
    }

    h1 {
      font-size: 48px;
      margin-bottom: 20px;
    }

    p {
      font-size: 20px;
      max-width: 600px;
      line-height: 1.6;
    }

    /* The circular magnifier element that follows the mouse */
    .magnifier {
      display: none;                      /* shown on hover */
      position: fixed;                    /* stays over viewport */
      width: var(--magnifier-size);
      height: var(--magnifier-size);
      border-radius: 50%;
      overflow: hidden;
      pointer-events: none;               /* doesn't block mouse events */
      z-index: 9999;
      border: 3px solid rgba(0,0,0,0.18);
      box-shadow: 0 6px 18px rgba(0,0,0,0.25);
      background: rgba(255,255,255,0.05);
      backdrop-filter: blur(0.5px);
    }

    /* Inner container that holds a scaled clone of the page content */
    .magnifier .zoom {
      position: absolute;
      left: 0;
      top: 0;
      will-change: transform, left, top;
    }

    /* The clone is positioned absolutely inside the .zoom and scaled */
    .magnifier .content-clone {
      position: absolute;
      left: 0;
      top: 0;
      transform-origin: 0 0; /* scale relative to top-left */
      pointer-events: none;
    }

    /* Small decorative center mark (optional) */
    .magnifier::after {
      content: "";
      position: absolute;
      left: calc(var(--magnifier-size) / 2 - 1px);
      top: calc(var(--magnifier-size) / 2 - 1px);
      width: 2px;
      height: 2px;
      background: rgba(0,0,0,0.35);
      border-radius: 50%;
      pointer-events: none;
      mix-blend-mode: multiply;
    }

    /* Improve rendering inside the clone */
    .content-clone * {
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    @media (max-width: 480px) {
      :root { --magnifier-size: 120px; --magnifier-zoom: 1.8; }
    }
  </style>
</head>

<body>
  <div class="content" id="content">
    <h1>Inspect the Details</h1>
    <p>
      This website uses a magnifying glass cursor to encourage
      exploration and close inspection of content. Move your mouse around
      to see the magnifying glass effect: the area under the magnifier
      is shown enlarged, like a real magnifying lens.
    </p>

    <p>
      The magnifier demonstrates a simple JavaScript approach that clones
      the page content and scales it inside a circular viewport that follows
      the cursor. This preserves the original layout and styles while providing
      a localized zoom.
    </p>

    <p>
      Try hovering different parts of the text and near the edges to see how
      the magnifier tracks and centers the content under the cursor.
    </p>
  </div>

  <!-- Magnifier element -->
  <div id="magnifier" class="magnifier" aria-hidden="true">
    <div class="zoom"></div>
  </div>

  <script>
    (function () {
      const content = document.getElementById('content');
      const magnifier = document.getElementById('magnifier');
      const zoomContainer = magnifier.querySelector('.zoom');

      const computedStyle = getComputedStyle(document.documentElement);
      const sizePx = parseFloat(computedStyle.getPropertyValue('--magnifier-size')) || 160;
      const zoomFactor = parseFloat(computedStyle.getPropertyValue('--magnifier-zoom')) || 2;

      // Create and insert a clone of the content inside the magnifier zoom area.
      const clone = content.cloneNode(true);
      clone.classList.add('content-clone');

      function updateCloneDimensions() {
        const rect = content.getBoundingClientRect();
        clone.style.width = rect.width + 'px';
      }

      updateCloneDimensions();
      clone.style.transform = `scale(${zoomFactor})`;
      zoomContainer.appendChild(clone);

      // Utility to apply a circular "hole" mask to the original content at (x,y) with radius r.
      function applyHideMask(x, y, r) {
        // radial-gradient: transparent inside the circle (hides original),
        // black outside (shows original). Works with mask and -webkit-mask.
        const grad = `radial-gradient(circle ${r}px at ${x}px ${y}px, transparent ${r - 0.5}px, black ${r}px)`;
        content.style.mask = grad;
        content.style.webkitMask = grad;
      }

      function clearHideMask() {
        content.style.mask = '';
        content.style.webkitMask = '';
      }

      // Show/hide magnifier when entering/leaving the content area.
      content.addEventListener('mouseenter', () => {
        updateCloneDimensions();
        magnifier.style.display = 'block';
      });

      content.addEventListener('mouseleave', () => {
        magnifier.style.display = 'none';
        clearHideMask();
      });

      window.addEventListener('resize', () => {
        updateCloneDimensions();
      });

      content.addEventListener('mousemove', (e) => {
        const rect = content.getBoundingClientRect();

        // cursor position relative to content's top-left
        const relX = e.clientX - rect.left;
        const relY = e.clientY - rect.top;

        const r = sizePx / 2;

        // position magnifier so its center is at the pointer (viewport coordinates)
        const magLeft = e.clientX - r;
        const magTop = e.clientY - r;
        magnifier.style.left = `${magLeft}px`;
        magnifier.style.top = `${magTop}px`;

        // Compute clone offsets so that the point under the cursor ends up at the magnifier center.
        const cloneLeft = r / zoomFactor - relX;
        const cloneTop = r / zoomFactor - relY;
        clone.style.left = `${cloneLeft}px`;
        clone.style.top = `${cloneTop}px`;

        // Hide the original content directly under the magnifier by applying a mask on the content element.
        // The mask position uses pixel coordinates relative to the content element.
        applyHideMask(relX, relY, r);
      });

      // Hide magnifier briefly on scroll to avoid jitter; restore mask on next mousemove.
      let scrollTimer = null;
      window.addEventListener('scroll', () => {
        if (magnifier.style.display === 'block') {
          magnifier.style.display = 'none';
          clearTimeout(scrollTimer);
          scrollTimer = setTimeout(() => {
            clearHideMask();
          }, 50);
        }
      });

      // Accessibility: disable for touch devices
      function isTouchDevice() {
        return (('ontouchstart' in window) || navigator.maxTouchPoints > 0);
      }
      if (isTouchDevice()) {
        magnifier.style.display = 'none';
      }
    })();
  </script>
</body>
</html>
